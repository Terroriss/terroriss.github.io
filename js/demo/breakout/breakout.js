var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(c=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+c+"$"+e),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:b})))};$jscomp.initSymbol=function(){};$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(f,g){this.$jscomp$symbol$id_=f;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",d=0,e=function(f){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new b(c+(f||"")+"_"+d++,f)};return e},"es6","es3");$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6","es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");var ball,game_info,game_loop,block_list=[];window.onunload=function(){ball&&!ball.closed&&ball.close();game_info&&!game_info.closed&&game_info.close();block_list.forEach(function(a){a&&!a.closed&&a.close()})};function getRandomInt(a,b){a=Math.ceil(a);b=Math.floor(b);return Math.floor(Math.random()*(b-a+1))+a}
function gameInfo(a){a=void 0===a?"":a;""!==a&&(block_list.forEach(function(b){b&&!b.closed&&b.close()}),ball&&!ball.closed&&ball.close(),document.querySelector(".play-game").classList.remove("hidden"),document.querySelector(".game-bar").classList.add("hidden"),window.moveTo(gameBoardLeft,gameBoardTop));game_info=window.open("","_blank","toolbar=no,scrollbars=no,location=no,menubar=no,statusbar=no,resizable=no,top="+gameBoardTop+",left="+gameBoardLeft+",width="+gameBoardWidth+",height="+gameBoardHeight);game_info.document.write('<html><head><title>Breakout Game | Minh Long</title><style>.game-control{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;width:100%;}.game-control>div{width:100%;display:flex;justify-content:center;}.game-info{position:absolute;top:10px;left:0;justify-content:space-between !important;}.h-score{padding-right:15px}.score{padding-left:15px;}.lvl{position:absolute;top:45px;font-size:26pt;left:50%;transform:translateX(-50%);}</style><script>function serve(){window.close();window.opener.gameServe();}\x3c/script><body><div class="game-control"><div class="game-info"><div class="score">Score: '+
score+'</div><div class="lvl">Level: '+current_level+'</div><div class="h-score">Highest Score: '+high_score+'</div></div><div class="game-status '+a+'">'+(""===a?"":"win"===a?"You won":"You lost")+'</div><div class="game-play"><div><button style="width:100%;" onclick="serve()">'+(""===a?"Serve Game":"win"===a?"Next Level":"Play Again")+"</button></div></div></div></body></html>")}gameInfo();function removeItemOnce(a,b){b=a.indexOf(b);-1<b&&a.splice(b,1);return a}
function gameServe(){document.querySelector(".game-bar").classList.remove("hidden");window.moveTo(gameBoardLeft,screenHeight-100);ball=window.open("","_blank","toolbar=no,scrollbars=no,location=no,menubar=no,statusbar=no,resizable=no,top="+(gameBarTop-ballSize-50)+",left="+(screenWidth/2-ballSize/2)+",width="+ballSize+",height="+ballSize);ball.document.write("<html><head><title>Ball</title><style>.ball{"+(isChrome?"max-width:100px;":"")+'position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100%;height:100%;border-radius:50%;background:red;}</style><body><div class="ball"><div></body></html>');window.focus();var a=LEVEL[current_level].cols,b=screenHeight/2/LEVEL[current_level].rows,c=screenWidth/a,d=0,e=0,f=1;LEVEL[current_level].map.forEach(function(g){"*"===g&&(g=window.open("","_blank","toolbar=no,scrollbars=no,location=no,menubar=no,statusbar=no,resizable=no,top="+e+",left="+d+",width="+c+",height="+b),g.document.write('<html><head><title>Breakout</title><body><script>var randomColor="#"+((1<<24)*Math.random()|0).toString(16);document.querySelector("body").style.background=randomColor;\x3c/script></body></html>'),block_list.push(g));d+=c;f+=1;f>a&&(f=1,d=0,e+=b)})}
function gamePlay(){ball_dx=getRandomInt(-150,150);ball_dy=getRandomInt(-30,-40);document.querySelector(".play-game").classList.add("hidden");document.addEventListener("keydown",function(a){if("ArrowRight"===a.code||"KeyD"===a.code)go_left=!1,window.moveBy(dx,0);if("KeyA"===a.code||"ArrowLeft"===a.code)go_left=!0,window.moveBy(-dx,0)});game_loop=setInterval(function(){var a=$jscomp.makeIterator(getCurrentBall()),b=a.next().value;a=a.next().value;if(0>=b||b+ball.outerWidth>=screenWidth)ball_dx=-ball_dx;40>=a&&(ball_dy=-ball_dy);a+ball.outerHeight>=screenHeight-10&&gameLose();if(collisionDetect(window,bar=!0)&&(ball_dy-=8,ball_dy=-ball_dy,0<ball_dy)){a=$jscomp.makeIterator(getCurrentBar());var c=a.next().value;a.next();b<c+gameBoardWidth/2&&go_left?ball_dx=-50+-(8*(c+gameBoardWidth/2-ball_dx)):b>c+gameBoardWidth/2&&!go_left&&(ball_dx=50+8*Math.abs(c+gameBoardWidth/2-ball_dx))}0===block_list.length&&gameWin();block_list.forEach(function(d){collisionDetect(d)&&(d.close(),score+=1,removeItemOnce(block_list,d))});ball.moveBy(ball_dx,ball_dy)},100)}function gameLose(){gameOver();gameInfo(state="lose")}function gameOver(){game_loop&&clearInterval(game_loop);score>high_score&&(high_score=score);localStorage.setItem("breakout",JSON.stringify({level:current_level,high_score:high_score}))}function gameWin(){gameOver();current_level<Object.keys(LEVEL).length&&(current_level+=1);gameInfo(state="win")}function getCurrentBall(){return[ball.screenX||ball.screenLeft,ball.screenY||ball.screenTop]}
function getCurrentBar(){return[window.screenX||window.screenLeft,window.screenY||window.screenTop]}function collisionDetect(a,b){var c=a.screenY||a.screenTop,d=a.screenX||a.screenLeft;b=!0===(void 0===b?!1:b)?c+130:c;var e=$jscomp.makeIterator(getCurrentBall());c=e.next().value;e=e.next().value;return!(e+ball.outerHeight<b||e>b+a.outerHeight||c+ball.outerWidth<d||c>d+a.outerWidth)};